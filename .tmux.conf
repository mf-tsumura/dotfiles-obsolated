# .tmux.confをごにょごにょする - mizchi log
# http://d.hatena.ne.jp/mizchi/20100829/1283076112
# をベースにした
# 他
# dotfiles/.tmux.conf at master · yuroyoro/dotfiles
# https://github.com/yuroyoro/dotfiles/blob/master/.tmux.conf
# Manpage of TMUX
# https://bytebucket.org/ns9tks/tmux-ja/wiki/tmux-ja.html
# 参照

# デフォルトキーバインドのメモ
# 時代はGNU screenからtmuxへ - Dマイナー志向
# http://d.hatena.ne.jp/tmatsuu/20090709/1247150771
# 等参考になるかと
# prefix & カレントウィンドウをkill
# prefix , カレントウィンドウをリネーム
# prefix ? 全キーバインドを列挙
# prefix ←↓↑→ ペイン移動
# prefix Meta-←↓↑→ ペインのサイズ変更
# prefix Space ペインの配置パターン変更
# prefix 0-9 そのウィンドウ番号のウィンドウへ移動
# 他
# $ tmux list-(commands|windows|keys|...) コマンドやリストを一覧表示
# $ tmux show-options [-g]でセッションオプションを、
# $ tmux show-window-options [-g]でウィンドウオプションを表示

# PrefixをC-tに
unbind-key C-b
set-option -g prefix C-t
bind-key t send-prefix

# 設定
set-window-option -g utf8 on
set-window-option -g status-utf8 on
# viスタイルのキーバインド
set-window-option -g mode-keys vi
# 実行されているコマンド名をウィンドウ名に
set-window-option -g automatic-rename on
# マウスでペインを選択可に
set-option -g mouse-select-pane on
# ウィンドウ番号を1から始める
set-option -g base-index 1
# 256色表示
set-option -g default-terminal screen-256color
# ターミナル(iTerm2等)のタイトルを設定
set-option -g set-titles on
# usename@host: tmuxみたく
# （※usernameとhostはtmuxを起動しているマシンのもの）
set-option -g set-titles-string "#(whoami)@#h: tmux"

# 見た目

# ステータスバー
# 5秒間隔で描画更新。デフォルトは15秒
set-option -g status-interval 5
# ステータスバーの左右の最大長。デフォルトはleftが10, rightが40
set-option -g status-left-length 30
set-option -g status-right-length 40
# 黒背景に白文字
set-option -g status-style "fg=white,bg=black"
# #Hはtmuxを起動しているマシンのホスト名。#hはそれからドメイン名を除いたもの
# #Sはセッション名
# 例
# [0]1:zsh* 2:Vim-
set-option -g status-left '#[fg=cyan,bold][#S]#[default]'
# C:57.1C M:60.0% [水 12/05/31 00:50]
set-option -g status-right '#[fg=red,bold]C:#(osx-cpu-temp | sed s/°//g) #[fg=green,bold]M:#(used-mem)%% #[fg=blue,bold][%a %y/%m/%d %H:%M]#[default]'
# メッセージ
# 赤背景に白太文字
set-option -g message-style "fg=white,bold,bg=red"

# ペインの区切り線のスタイル
set-window-option -g pane-active-border-style "fg=cyan,bg=black"
set-option -g pane-border-style "fg=white,bg=black"
set-window-option -g window-status-current-style "fg=blue"

set-window-option -g mode-style "fg=black,bg=white"
# ステータスラインでのウィンドウ一覧のスタイル
set-window-option -g window-status-style "fg=white,bg=black"
set-window-option -g window-status-current-style "fg=black,bg=white"

# キーバインド
unbind-key l

# 新しいウィンドウを開くときは今のペインと同じディレクトリで開く
unbind-key c
bind-key c new-window -c "#{pane_current_path}"

# prefix C-Cでもprefix cと同じく新しいウィンドウを開く
unbind-key C-c
bind-key C-c new-window -c "#{pane_current_path}"

# prefix C-dでデタッチ（デフォルトではprefix dのみ）
unbind-key C-d
bind-key C-d detach

# prefix C-tで次のウィンドウへ
bind-key C-t next-window
# prefix C-nで次のウィンドウへ（デフォルトではprefix nのみ）
unbind-key C-n
bind-key C-n next-window
# prefix C-pで前のウィンドウへ（デフォルトではprefix pのみ）
unbind-key C-p
bind-key C-p previous-window

# prefix C-rで.tmux.conf再読み込み
bind-key C-r source-file ~/.tmux.conf
# prefix bでそのペインをウィンドウとして切り離す
bind-key b break-pane
# prefix v, hでペイン分割
bind-key v split-window -v
bind-key h split-window -h

# ペインの移動
bind-key -r C-h select-pane -L
bind-key -r C-l select-pane -R
bind-key -r C-j select-pane -D
bind-key -r C-k select-pane -U
# ペインのスワップ
bind-key -r s swap-pane -U

# prefix kでそのペインをkillする
bind-key k confirm-before 'kill-pane'
# prefix Kでそのウィンドウをkillする
bind-key K confirm-before 'kill-window'
# prefix qでそのセッションをkill-sessionする
bind-key q confirm-before 'kill-session'
# prefix C-qでtmuxそのもの（サーバとクライアント）をkillする
bind-key C-q confirm-before 'kill-server'
# prefix iでペーン番号を大きく表示
bind-key i display-panes
# prefix |で時計を大きく表示
bind-key | clock-mode
# prefix yでコピーモードへ（デフォルトではprefix [）
bind-key y copy-mode
# prefix pでペーストモードへ（デフォルトではprefix ]）
bind-key p paste-buffer
# ちなみに、コピーモードでの操作は、Spaceで始点をマークしEnterで終点をマーク
# (viキーバインドの場合)

# Macのクリップボードを使えるように
# ちなみにこの設定のまま他のOS環境に持っていくと動かなくなるので
# 他のOSで使う時はコメントアウト等
# Mac の tmux でクリップボードを使う。 - こせきの技術日記
# http://d.hatena.ne.jp/koseki2/20110816/TmuxCopy
set-option -g default-command 'reattach-to-user-namespace -l zsh'
# prefix C-bで直前のバッファをクリップボードに送る
bind-key C-b run-shell 'reattach-to-user-namespace tmux-pbcopy'

